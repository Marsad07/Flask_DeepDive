<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% block title %}Task Manager{% endblock %}</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>

<style>
    .account-bar {
        position: fixed;
        top: 10px;
        right: 20px;
        background-color: #013d38;
        padding: 10px 15px;
        border-radius: 8px;
        color: white;
        display: flex;
        gap: 15px;
        align-items: center;
        z-index: 1000;
    }

    .account-bar a {
        color: white;
        text-decoration: none;
        font-weight: bold;
    }

    .account-bar a:hover {
        text-decoration: underline;
    }

    nav ul {
        list-style: none;
        margin: 0;
        padding: 0;
        background-color: #013d38;
        width: 200px;
        height: 100vh;
        position: fixed;
        top: 0;
        left: 0;
        padding-top: 0px;
    }

    nav ul li a {
        display: block;
        padding: 10px 16px;
        color: white;
        text-decoration: none;
    }

    nav ul li a:hover {
        background-color: #111613;
    }

    .dropdown-btn {
        cursor: pointer;
        display: block;
        padding: 8px 16px;
        color: white;
    }

    .dropdown-content {
        list-style: none;
        padding-left: 20px;
        margin: 0;
        background-color: #013d38;
        display: none;
    }

    .dropdown-content li a {
        display: block;
        padding: 6px 16px;
        color: white;
        text-decoration: none;
    }

    .dropdown-content li a:hover {
        background-color: #111613;
    }

    .content {
        margin-left: 280px;
        padding: 20px;
    }
</style>
<body>

    {% if session.get('user_id') %}
    <div class="account-bar">
        <span>Welcome, {{ session['user_name'] }}</span>
        <a href="{{ url_for('auth.logout') }}">Logout</a>
    </div>
    {% endif %}

    <nav>
        <ul>
            <li><a href="{{ url_for('general.homepage') }}">üè† Home</a></li>

            {% if session.get('user_id') %}
                <li><a href="{{ url_for('tasks.add_task_page') }}">‚ûï Add Task</a></li>
                <li><a href="{{ url_for('auth.profile') }}">üë§ Profile</a></li>
                <li><a href="{{ url_for('general.pomodoro') }}">‚è±Ô∏è Pomodoro</a></li>
                <li><a href="{{ url_for('atlas.chat_page') }}">ü§ñ Atlas AI</a></li>

                <li class="dropdown">
                    <div class="dropdown-header">
                        <a href="{{ url_for('subjects.subjects') }}" class="subjects-link">Subjects</a>
                        <span class="subjects-toggle" onclick="toggleSubjects()">‚ñº</span>
                    </div>

                    <ul id="subjectsDropdown" class="dropdown-content">
                        <li><a href="javascript:void(0)" onclick="toggleSubjects()">‚Üê Back</a></li>

                        {% for subject in sidebar_subjects %}
                            <li><a href="{{ url_for('subjects.subject_page', subject_id=subject.id) }}">
                                {{ subject.name }}</a></li>
                        {% endfor %}
                    </ul>
                </li>

                <li class="help-link"><a href="{{ url_for('general.help_page') }}">‚è±Help and Support‚ùî</a></li>

            {% else %}
                <li><a href="{{ url_for('auth.login') }}">Login</a></li>
                <li><a href="{{ url_for('auth.register') }}">Register</a></li>
            {% endif %}
        </ul>
    </nav>

    <div class="content">
        {% block content %}{% endblock %}
    </div>
    <script>
    function toggleSubjects() {
        const menu = document.getElementById("subjectsDropdown");

        if (menu.style.display === "block") {
            menu.style.display = "none";
        } else {
            menu.style.display = "block";
        }
    }
</script>

</body>
</html>
